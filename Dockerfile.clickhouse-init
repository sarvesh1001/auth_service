FROM clickhouse/clickhouse-server:24.8

# Install curl for any healthcheck scripts
RUN apt-get update && apt-get install -y curl && rm -rf /var/lib/apt/lists/*

WORKDIR /app

# Copy initialization script
COPY ./scripts/init-clickhouse.sh /docker-entrypoint-initdb.d/init-clickhouse.sh
RUN chmod +x /docker-entrypoint-initdb.d/init-clickhouse.sh

# Use default ClickHouse entrypoint
ENTRYPOINT ["/entrypoint.sh"]
